test = read.table("./test/X_test.txt")
train = read.table("./train/X_train.txt")
data = rbind(test,train)
newdata = data[,c("V1","V2","V3","V4","V5","V6","V41","V42","V43","V44","V45","V46","V81","V82","V83","V84","V85","V86","V121","V122","V123","V124","V125","V126","V161","V162","V163","V164","V165","V166","V201","V202","V214","V215","V227","V228","V240","V241","V253","V254","V266","V267","V268","V269","V270","V271","V345","V346","V347","V348","V349","V350","V424","V425","V426","V427","V428","V429","V503","V504","V516","V517","V529","V530","V542","V543")]
colnames(newdata) = c("tBodyAcc-mean()-X","tBodyAcc-mean()-Y","tBodyAcc-mean()-Z","tBodyAcc-std()-X","tBodyAcc-std()-Y","tBodyAcc-std()-Z","tGravityAcc-mean()-X","tGravityAcc-mean()-Y","tGravityAcc-mean()-Z","tGravityAcc-std()-X","tGravityAcc-std()-Y","tGravityAcc-std()-Z","tBodyAccJerk-mean()-X","tBodyAccJerk-mean()-Y","tBodyAccJerk-mean()-Z","tBodyAccJerk-std()-X","tBodyAccJerk-std()-Y","tBodyAccJerk-std()-Z","tBodyGyro-mean()-X","tBodyGyro-mean()-Y","tBodyGyro-mean()-Z","tBodyGyro-std()-X","tBodyGyro-std()-Y","tBodyGyro-std()-Z","tBodyGyroJerk-mean()-X","tBodyGyroJerk-mean()-Y","tBodyGyroJerk-mean()-Z","tBodyGyroJerk-std()-X","tBodyGyroJerk-std()-Y","tBodyGyroJerk-std()-Z","tBodyAccMag-mean()","tBodyAccMag-std()","tGravityAccMag-mean()","tGravityAccMag-std()","tBodyAccJerkMag-mean()","tBodyAccJerkMag-std()","tBodyGyroMag-mean()","tBodyGyroMag-std()","tBodyGyroJerkMag-mean()","tBodyGyroJerkMag-std()","fBodyAcc-mean()-X","fBodyAcc-mean()-Y","fBodyAcc-mean()-Z","fBodyAcc-std()-X","fBodyAcc-std()-Y","fBodyAcc-std()-Z","fBodyAccJerk-mean()-X","fBodyAccJerk-mean()-Y","fBodyAccJerk-mean()-Z","fBodyAccJerk-std()-X","fBodyAccJerk-std()-Y","fBodyAccJerk-std()-Z","fBodyGyro-mean()-X","fBodyGyro-mean()-Y","fBodyGyro-mean()-Z","fBodyGyro-std()-X","fBodyGyro-std()-Y","fBodyGyro-std()-Z","fBodyAccMag-mean()","fBodyAccMag-std()","fBodyBodyAccJerkMag-mean()","fBodyBodyAccJerkMag-std()","fBodyBodyGyroMag-mean()","fBodyBodyGyroMag-std()","fBodyBodyGyroJerkMag-mean()","fBodyBodyGyroJerkMag-std()")
test_name = read.table("./test/y_test.txt")
train_name = read.table("./train/y_train.txt")
data_name = rbind(test_name,train_name)
newdata1 = cbind(data_name,newdata)
for (i in 1:10299) {
  if (newdata1$V1[i] == 1) {newdata1$V1[i]="WALKING"}
  else if (newdata1$V1[i] == 2) {newdata1$V1[i] = "WALKING_UPSTAIRS"}
  else if (newdata1$V1[i] == 3) {newdata1$V1[i] = "WALKING_DOWNSTAIRS"}
  else if (newdata1$V1[i] == 4) {newdata1$V1[i] = "SITTING"}
  else if (newdata1$V1[i] == 5) {newdata1$V1[i] = "STANDING"}
  else if (newdata1$V1[i] == 6) {newdata1$V1[i] = "LAYING"}  
}
newdata2 = newdata1[,c(1,2,3,4,8,9,10,14,15,16,20,21,22,26,27,28,32,34,36,38,40,42,43,44,48,49,50,54,55,56,60,62,64,66)]
test1 = split(newdata2[,2],newdata2[,1])
testavg1 = sapply(test1,mean)
test2 = split(newdata2[,3],newdata2[,1])
testavg2 = sapply(test2,mean)
test3 = split(newdata2[,4],newdata2[,1])
testavg3 = sapply(test3,mean)
test4 = split(newdata2[,5],newdata2[,1])
testavg4 = sapply(test4,mean)
test5 = split(newdata2[,6],newdata2[,1])
testavg5 = sapply(test5,mean)
test6 = split(newdata2[,7],newdata2[,1])
testavg6 = sapply(test6,mean)
test7 = split(newdata2[,8],newdata2[,1])
testavg7 = sapply(test7,mean)
test8 = split(newdata2[,9],newdata2[,1])
testavg8 = sapply(test8,mean)
test9 = split(newdata2[,10],newdata2[,1])
testavg9 = sapply(test9,mean)
test10 = split(newdata2[,11],newdata2[,1])
testavg10 = sapply(test10,mean)
test11 = split(newdata2[,12],newdata2[,1])
testavg11 = sapply(test11,mean)
test12 = split(newdata2[,13],newdata2[,1])
testavg12 = sapply(test12,mean)
test13 = split(newdata2[,14],newdata2[,1])
testavg13 = sapply(test13,mean)
test14 = split(newdata2[,15],newdata2[,1])
testavg14 = sapply(test14,mean)
test15 = split(newdata2[,16],newdata2[,1])
testavg15 = sapply(test15,mean)
test16 = split(newdata2[,17],newdata2[,1])
testavg16 = sapply(test16,mean)
test17 = split(newdata2[,18],newdata2[,1])
testavg17 = sapply(test17,mean)
test18 = split(newdata2[,19],newdata2[,1])
testavg18 = sapply(test18,mean)
test19 = split(newdata2[,20],newdata2[,1])
testavg19 = sapply(test19,mean)
test20 = split(newdata2[,21],newdata2[,1])
testavg20 = sapply(test20,mean)
test21 = split(newdata2[,22],newdata2[,1])
testavg21 = sapply(test21,mean)
test22 = split(newdata2[,23],newdata2[,1])
testavg22 = sapply(test22,mean)
test23 = split(newdata2[,24],newdata2[,1])
testavg23 = sapply(test23,mean)
test24 = split(newdata2[,25],newdata2[,1])
testavg24 = sapply(test24,mean)
test25 = split(newdata2[,26],newdata2[,1])
testavg25 = sapply(test25,mean)
test26 = split(newdata2[,27],newdata2[,1])
testavg26 = sapply(test26,mean)
test27 = split(newdata2[,28],newdata2[,1])
testavg27 = sapply(test27,mean)
test28 = split(newdata2[,29],newdata2[,1])
testavg28 = sapply(test28,mean)
test29 = split(newdata2[,30],newdata2[,1])
testavg29 = sapply(test29,mean)
test30 = split(newdata2[,31],newdata2[,1])
testavg30 = sapply(test30,mean)
test31 = split(newdata2[,32],newdata2[,1])
testavg31 = sapply(test31,mean)
test32 = split(newdata2[,33],newdata2[,1])
testavg32 = sapply(test32,mean)
test33 = split(newdata2[,34],newdata2[,1])
testavg33 = sapply(test33,mean)
result =cbind(testavg1,testavg2,testavg3,testavg4,testavg5,testavg6,testavg7,testavg8,testavg9,testavg10,testavg11,testavg12,testavg13,testavg14,testavg15,testavg16,testavg17,testavg18,testavg19,testavg20,testavg21,testavg22,testavg23,testavg24,testavg25,testavg26,testavg27,testavg28,testavg29,testavg30,testavg31,testavg32,testavg33)
colnames(result) = c("tBodyAcc-mean()-X","tBodyAcc-mean()-Y","tBodyAcc-mean()-Z","tGravityAcc-mean()-X","tGravityAcc-mean()-Y","tGravityAcc-mean()-Z","tBodyAccJerk-mean()-X","tBodyAccJerk-mean()-Y","tBodyAccJerk-mean()-Z","tBodyGyro-mean()-X","tBodyGyro-mean()-Y","tBodyGyro-mean()-Z","tBodyGyroJerk-mean()-X","tBodyGyroJerk-mean()-Y","tBodyGyroJerk-mean()-Z","tBodyAccMag-mean()","tGravityAccMag-mean()","tBodyAccJerkMag-mean()","tBodyGyroMag-mean()","tBodyGyroJerkMag-mean()","fBodyAcc-mean()-X","fBodyAcc-mean()-Y","fBodyAcc-mean()-Z","fBodyAccJerk-mean()-X","fBodyAccJerk-mean()-Y","fBodyAccJerk-mean()-Z","fBodyGyro-mean()-X","fBodyGyro-mean()-Y","fBodyGyro-mean()-Z","fBodyAccMag-mean()","fBodyBodyAccJerkMag-mean()","fBodyBodyGyroMag-mean()","fBodyBodyGyroJerkMag-mean()")
write.table(result,file="tidedata.txt",row.name=TRUE)
